{% extends "base_generic.html" %}
{% load static %}

{% block title %}
<title>{{name}}</title>
{% endblock %}

{% block extra_static %}
<!-- show-shortcut specific CSS -->
<link rel="stylesheet" href="{% static 'css/view.css' %}">
<!-- save-file-to-device library -->
<script defer src="{% static 'js/FileSaver.min.js' %}"></script>
<!-- DOM => Image library -->
<script defer src="{% static 'js/dom-to-image.min.js' %}"></script>
<!-- implementation of libraries to take "screenshot" -->
<script defer src="{% static 'js/screenshot.js' %}"></script>
{% endblock %}

{% block sidebar %}
{% include 'sidebar.html' with hidden=False %}
{% endblock %}

{% block content %}
<div class="content">
  <!-- # header -->
  <div class="header" id='SCtitle'>

    <div class='floater'></div>

    <!-- ## open btn -->
    <span id='open'>
      {% if menu_icon %}
      <img src="{% static menu_icon %}" />
      {% else %}
      <img src="{% static 'assets/ui/menu.svg' %}" />
      {% endif %}
    </span>

    <!-- ## Shortcut Icon -->
    <div id="glyph-bg" style="background-color:rgb{{color_code}}">
      <img id='glyph_icon' src="{% static glyph_icon %}" />
    </div>

    <!-- ## Shortcut Name -->
    <div class="sc-title" title="{{name}}">
      {{name}}
    </div>

    <div class='floater'></div>
    <div class="align-5"></div>
  </div>
  <div class='floater'></div>

  <!-- # Shortcut Actions -->
  <div id="action-container" class="article-container">
    <!-- secondary name element, hidden behind the header, appears in screenshots -->
    <div class="sc-title" title="{{name}}" style="position:absolute;top:1.5rem;left:2rem">{{name}}</div>
    <!-- # Dummy Container contains grey line pseudo-element (see CSS) -->
    <div class="dummy">
      <!-- ## Shows "Accepts: Images, Text, ..." if Shortcut is an action extension -->
      {% if accepted_types %}
      <div class='action'>
        <div id='accepts'>Accepts</div>
        <div id='accepted-types'>{{accepted_types}}</div>
      </div>
      {% endif %}

      <!-- ACTIONS -->
      <!-- limited to 100 for free users -->
      {% for action in action_blocks|slice:":100" %}
      {% include 'elements/action.html' with action=action UUID_glyphs=UUID_glyphs %}
      {% endfor %}

    </div>

    <!-- line art logo -->
    <div id='screenshot-mark'>
      <img src="{% static 'assets/logo/line.svg' %}" />
      <p>Showcuts</p>
    </div>

  </div>
  <div class='floater'></div>
  <div class="align-5"></div>

  <!-- # Right Sidebar -->
  <div class='tool-container'>
    <a href="{{iCloud_link}}" id='ios-download' title='Download from iCloud'>
      <div class='tool-btn expand'>
        <img src="{% static 'assets/ui/cloud-download-outline.svg' %}" />
        <p>iCloud</p>
      </div>
    </a>
    <!-- Magic Var: toggles visibility of magic variables -->
    <a id='show-magic' title='Magic Variables'>
      <div class='tool-btn expand'>
        <img src="{% static 'assets/ui/wand.svg' %}" />
        <p>Magic Vars</p>
      </div>
    </a>
    <a id='screenshot' title='Export Image'>
      <div class='tool-btn expand'>
        <img src="{% static 'assets/ui/photo-square-white.svg' %}" />
        <p>Screenshot</p>
      </div>
    </a>
    <div id='info' title='Shortcut Info'>
      {% if workflow_version < min_version %}
      <div class='tool-btn danger' id='info-expand'>
        <img src="{% static 'assets/ui/warning-white.svg' %}" />
      </div>
      {% else %}
      <div class='tool-btn' id='info-expand'>
        <img src="{% static 'assets/ui/info.svg' %}" />
      </div>
      {% endif %}
    </div>

    <p>
      <!-- submission timestamp -->
      {% if owner.username == user.username %}
      Submitted {{sc_age}} ago
      {% elif owner.username %}
      Submitted by {{owner.username}} {{sc_age}} ago
      {% else %}
      Submitted Anonymously {{sc_age}} ago
      {% endif %}
      
      <!-- workflow client number -->
      {% if workflow_version < min_version %}<br/><br/>This is an old shortcut, so some variables might be missing!{% endif %}
    </p>


    <!-- logged in buttons -->
    <div id="like" class="tool-btn line-art {{user.username|yesno:',disabled,'}} {{liked|yesno:'clicked,,'}}"
      title="{{user.username|yesno:'Like,Login to Like,'}}" hxid="{{hxid}}">
      <img src="{% static 'assets/ui/heart-fill.svg' %}" />
    </div>
    <p id="likes">{{likes}}</p>
    <div id="save" class="tool-btn line-art {{user.username|yesno:',disabled,'}}  {{saved|yesno:'clicked,,'}}"
      title='{{user.username|yesno:'Save,Login to Save,'}}' hxid="{{hxid}}">
      <img src="{% static 'assets/ui/bookmark-fill.svg' %}" />
    </div>

    <!-- buttons for sharing to other sites -->
    <div id="xpost" class="tool-btn line-art" title='Share Shortcut'>
      <img src="{% static 'assets/ui/share.svg' %}" />
    </div>
    <a id="reddit" href='http://{{request.get_host}}/share/reddit/{{hxid}}' class='xpost-wrapper' title=''>
      <img src="{% static 'assets/branding/reddit.svg' %}" />
    </a>
    <a id="twitter"
      href='https://twitter.com/intent/tweet?text=https://showcuts.app/share/view/{{hxid}}%0ACheck%20out%20this%20Shortcut!'
      class='xpost-wrapper' title='Tweet' target="_blank">
      <img src="{% static 'assets/branding/twitter.svg' %}" />
    </a>
  </div>
  {% if action_blocks|length > 100 %}
  {% with remainder=action_blocks|length|add:-100 %}
  <div class='fade-out'>
    <div class='gate-text'>{{remainder}} more action{{remainder|pluralize}}</div>
  </div>
  {% endwith %}
  {% endif %}
</div>
{% endblock %}